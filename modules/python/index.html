<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://crcresearch.github.io/ndcmsT3/modules/python/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Python - CMS Tier 3 at University of Notre Dame</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Python";
        var mkdocs_page_input_path = "modules/python.md";
        var mkdocs_page_url = "/ndcmsT3/modules/python/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../images/crc_logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">HOME</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">NEW USER INFO</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../new_user/obtain_account/">Obtaining a CRC account</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../new_user/quick_start/">Quick Start Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../new_user/connecting_to_crc/">Connecting to CRC Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../new_user/linux_guide/">Basic Linux Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../new_user/modules/">Modules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../new_user/introductory_videos/">Introductory Videos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../new_user/training/">Training Events</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">HELP</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../help/faq/">FAQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../help/help/">Getting Help</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">CRC INFRASTRUCTURE</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../crc_infra/resources/">CRC Resources</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../crc_infra/software/">CRC Software</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../crc_infra/available_hardware/">Available Hardware</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../crc_infra/storage/">Storage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../crc_infra/crc_uge_env/">UGE Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../crc_infra/faculty_infrastructure/">Faculty Cluster Partnership Program</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../crc_infra/landing/">Maintenance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RESOURCES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../resources/gpu/">GPU</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../resources/condor/">HTCondor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../resources/globus/">Globus</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../resources/ndcms/">NDCMS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../resources/singularity/">Apptainer/Singularity</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../resources/caml/">CAML</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">POPULAR MODULES</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../matlab/">Matlab</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Python</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#basic-usage">Basic Usage</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#installing-python-packages-locally">Installing Python Packages Locally</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#adding-homelocalbin-to-your-path">Adding \${HOME}/.local/bin to your path</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#python-virtual-environment">Python Virtual Environment</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#job-submission-example">Job Submission Example</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#multi-core-jobs">Multi-core Jobs</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#further-information">Further Information</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../r/">R</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tensorflow/">Tensorflow</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../conda/">Conda</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">CMS Tier 3 at University of Notre Dame</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">POPULAR MODULES</li>
      <li class="breadcrumb-item active">Python</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/crcresearch/ndcmsT3/edit/master/docs/modules/python.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="python">Python</h1>
<p><img alt="image" src="../../images/python-logo-master-v3-TM.png" /></p>
<p>Python is an interpreted, interactive, object-oriented programming language. It incorporates modules, exceptions, dynamic typing, very high level dynamic data types, and classes. Python combines remarkable power with very clear syntax. It has interfaces to many system calls and libraries, as well as to various window systems, and is extensible in C or C++. It is also usable as an extension language for applications that need a programmable interface. Finally, Python is portable: it runs on many Unix variants, on the Mac, and on PCs under MS-DOS, Windows, Windows NT, and OS/2.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Starting in May, 2019, the CRC Python module defaults to <code>Python 3</code>. If you are using code based on <code>Python 2</code>, we highly recommend moving to the 3.X branch of Python. Python 2 stopped being maintained in January of 2020 and have been completely removed from RHEL8.</p>
</div>
<hr />
<h2 id="basic-usage">Basic Usage</h2>
<p>A default version of Python is available on any of our machines that run Redhat Enterprise Linux. The default version is considered to be extremely stable, but does tend to be several iterations behind the most recent version. You can check the version number with the following command:</p>
<pre class="highlight"><code class="language-shell">$ python3 --version
Python 3.6.8</code></pre>
<p>To provide the additional functionality of more recent versions, the CRC maintains additional Python modules. The current offerings can be seen with this command:</p>
<pre class="highlight"><code class="language-shell">$ module avail python
---------------------------------- /afs/crc.nd.edu/x86_64_linux/Modules/modules/development_tools_and_libraries -----------------------------------
python/3.7.3</code></pre>
<p>To load the default Python module:</p>
<pre class="highlight"><code class="language-shell">$ module load python</code></pre>
<p>In addition, we often install popular packages to go along with the module versions. For example, the packages <a href="https://www.numpy.org">NumPy</a> and <a href="https://www.scipy.org">SciPy</a> are available through any of the above listed modules.</p>
<hr />
<h2 id="installing-python-packages-locally">Installing Python Packages Locally</h2>
<p>If you need a package that is not installed with the CRC version of Python, then you can easily install it locally in your personal AFS space using the following instructions.</p>
<p>''pip'' is a useful tool for installing Python packages, particularly those with many dependencies.</p>
<p>Installing a python package is as easy using the pip3 command:</p>
<pre class="highlight"><code class="language-shell">module load python
pip3 install --user package_name</code></pre>
<p>If the package is distributed as a compressed tar file, such as ''package.tar.gz'':</p>
<ul>
<li>Download the Python package</li>
<li>Unpack it in your CRC space: <code>tar -xzf package.tar.gz</code></li>
<li>Change to the unpacked directory: <code>cd package</code></li>
<li>Install the package: <code>python3 setup.py install --user</code> This will install all of the files in your home directory under <code>~/.local/</code></li>
<li>When you load Python, the local package should now be accessible (via ''import'').</li>
</ul>
<h3 id="adding-homelocalbin-to-your-path">Adding \${HOME}/.local/bin to your path</h3>
<p>When using the <code>--user</code> option above, a Python package may also install helper applications in addition to source code. By default, these programs will be installed into the directory:</p>
<pre class="highlight"><code class="language-shell">${HOME}/.local/bin</code></pre>
<p>You may always give the full path to the application, but it is often easier to add this directory to the variable <code>$PATH</code>, so that only the name of the program is required to run it. If you are using the BASH shell, the following line will add it:</p>
<pre class="highlight"><code class="language-shell">echo 'export PATH=${HOME}/.local/bin:${PATH}' &gt;&gt; ~/.bashrc</code></pre>
<p>Similarly, for TCSH:</p>
<pre class="highlight"><code class="language-shell">echo 'setenv PATH ${HOME}/.local/bin:${PATH}' &gt;&gt; ~/.cshrc</code></pre>
<p>If you're not sure which shell you are using, input this command:</p>
<pre class="highlight"><code class="language-shell">echo $0</code></pre>
<p>The next time you log in or <code>source</code> your startup script, programs in <code>${HOME}/.local/bin</code> will be available without the need for specifying the exact location.</p>
<hr />
<h2 id="python-virtual-environment">Python Virtual Environment</h2>
<p>Having a virtual environment can be useful if you want to install software, but do not want that software to be installed globally. Using <code>virtualenv</code> will allow you to install packages and easily delete them once you are finished.</p>
<p>As an alternative to <code>virtualenv</code>, the CRC supports a <code>conda</code> module.</p>
<p>To use <code>virtualenv</code> you must first load a python module:</p>
<pre class="highlight"><code class="language-shell">module load python</code></pre>
<p>Next, install the virtualenv package into your user space:</p>
<pre class="highlight"><code class="language-shell">pip3 install --user virtualenv</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The virtualenv executable will not be automatically added to your path.</p>
</div>
<p>Next, you will need to create a folder named whatever you like and move into it:</p>
<pre class="highlight"><code class="language-shell">mkdir virtualProject
cd virtualProject</code></pre>
<p>Next, create the virtual environment naming it whatever you want:</p>
<pre class="highlight"><code class="language-shell">~/.local/bin/virtualenv NameOfVirtualEnviroment</code></pre>
<p>The virtual environment has been created, but it still needs to be activated:</p>
<pre class="highlight"><code class="language-shell">source NameOfVirtualEnviroment/bin/activate</code></pre>
<p>You will notice that the name of your virtual environment will now appear on the left of the prompt like this:</p>
<pre class="highlight"><code class="language-shell">(NameOfVirtualEnviroment)userName@nameOfMachine:~/virtualProject $</code></pre>
<p>This indicates that your virtual environment is currently active. You are now able to install packages into it without affecting global packages. To deactivate your virtual environment simply by type:</p>
<pre class="highlight"><code class="language-shell">deactivate</code></pre>
<p>If you ever forget which packages you had installed in which virtual environment, type:</p>
<pre class="highlight"><code class="language-shell">pip3 freeze</code></pre>
<p>into an activate virtual environment and the terminal will list which packages are installed. Try creating a virtual environment and installing a package in that environment. Then type <code>pip3 freeze</code>` when the virtual environment is first active and then de-active. You will notice that the packages are different, and that is the whole point of the Python Virtual Environment: to have different packages in different virtual environments without affecting global packages.</p>
<p>When you are finished with a virtual environment and no longer need it or the packages it has installed, simply delete the folder the virtual environment resides in:</p>
<pre class="highlight"><code class="language-shell">rm -rf NameOfFolder</code></pre>
<p>The virtual environment has now been deleted and global packages have not changed at all.</p>
<hr />
<h2 id="job-submission-example">Job Submission Example</h2>
<p>The following is a basic template for creating a UGE job submission script for a python job</p>
<pre class="highlight"><code class="language-shell">#!/bin/bash
#$ -M netid@nd.edu      # Email address for job notification
#$ -m abe               # Send mail when job begins, ends and aborts
#$ -q long              # Specify queue
#$ -pe smp 1            # Specify number of cores to use.
#$ -N helloWorld        # Specify job name

module load python

python3 HelloWorld.py</code></pre>
<p>Where HelloWorld.py contains:</p>
<pre class="highlight"><code class="language-shell">#!/usr/bin/env python3

print("Hello World!\n")</code></pre>
<h3 id="multi-core-jobs">Multi-core Jobs</h3>
<p>Many python packages are written to take advantage of multiple processing units (cores) to solve problems more quickly by executing code in parallel. Our batch system supports this feature through a two step process. First, you must let the batch system know how many resources you are requesting via the <code>-pe smp</code> flag. Second, and most important, you must also tell Python how many resources to use. By default, Python will assume that it is able to use all resources that it is aware of. In the best case, this can lead to a compute node being overtaxed and slowing down all jobs running. In the worst case, it can crash the node. We tell Python how many cores it is allowed to use through an environment variable named <code>OMP_NUM_THREADS</code>. Typically, we set this variable to the same value as that we set in our <code>#$ -pe smp</code> flag via another variable, <code>$NSLOTS</code>. For example, the following BASH script will run a Python program that is written to take advantage of multiple cores using at most 4 cores:</p>
<pre class="highlight"><code class="language-shell">#!/bin/bash
#$ -q long
#$ -pe smp 4
export OMP_NUM_THREADS=${NSLOTS}
module load python
python3 numpy-test.py</code></pre>
<p>The equivalent (T)CSH script would be:</p>
<pre class="highlight"><code class="language-shell">#!/bin/tcsh
#$ -q long
#$ -pe smp 4
setenv OMP_NUM_THREADS ${NSLOTS}
module load python
python3 numpy-test.py</code></pre>
<hr />
<h2 id="further-information">Further Information</h2>
<p>See the official site: <a href="https://www.python.org/">Python.org</a></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../matlab/" class="btn btn-neutral float-left" title="Matlab"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../r/" class="btn btn-neutral float-right" title="R">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/crcresearch/ndcmsT3" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../matlab/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../r/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
